# å¿«é€Ÿå¯åŠ¨æŒ‡å—

## ğŸ“¦ å·²å®Œæˆçš„QLExpressæ¨¡å‹ç®¡ç†åŠŸèƒ½

### âœ… åç«¯ç»„ä»¶
- QLExpress 3.3.2è§„åˆ™å¼•æ“
- 5ä¸ªæ–°æ•°æ®åº“è¡¨
- å®Œæ•´çš„æ¨¡å‹ç®¡ç†API
- å®æ—¶è¡¨è¾¾å¼éªŒè¯

### âœ… å·²åˆ›å»ºçš„æ–‡ä»¶
```
pom.xml (å·²æ›´æ–°)
src/main/java/com/evaluate/
â”œâ”€â”€ entity/
â”‚   â”œâ”€â”€ EvaluationModel.java
â”‚   â”œâ”€â”€ ModelStep.java
â”‚   â””â”€â”€ StepAlgorithm.java
â”œâ”€â”€ mapper/
â”‚   â”œâ”€â”€ EvaluationModelMapper.java
â”‚   â”œâ”€â”€ ModelStepMapper.java
â”‚   â””â”€â”€ StepAlgorithmMapper.java
â”œâ”€â”€ service/
â”‚   â”œâ”€â”€ QLExpressService.java
â”‚   â””â”€â”€ impl/QLExpressServiceImpl.java
â””â”€â”€ controller/
    â””â”€â”€ ModelManagementController.java

migrations/
â”œâ”€â”€ 002_create_model_management.sql
â””â”€â”€ 003_init_model_formulas.sql
```

## ğŸš€ ç«‹å³ä½¿ç”¨ï¼ˆ3æ­¥å¯åŠ¨ï¼‰

### æ­¥éª¤1: æ‰§è¡Œæ•°æ®åº“è¿ç§» (2åˆ†é’Ÿ)

æ‰“å¼€ä»»æ„MySQLå®¢æˆ·ç«¯å·¥å…·ï¼ˆHeidiSQL/Navicat/MySQL Workbenchï¼‰ï¼Œæ‰§è¡Œï¼š

```sql
-- è¿æ¥ä¿¡æ¯
-- Host: localhost:3306
-- User: root
-- Password: Htht1234
-- Database: evaluate_db

-- ä¾æ¬¡æ‰§è¡Œä»¥ä¸‹æ–‡ä»¶ï¼š
SOURCE C:/Users/Administrator/Development/evaluation/migrations/002_create_model_management.sql;
SOURCE C:/Users/Administrator/Development/evaluation/migrations/003_init_model_formulas.sql;
```

æˆ–è€…åœ¨PowerShellä¸­ï¼ˆå¦‚æœæ‰¾åˆ°MySQLè·¯å¾„ï¼‰ï¼š
```powershell
# æŸ¥æ‰¾MySQLå®‰è£…ç›®å½•
Get-ChildItem "C:\Program Files\MySQL" -Recurse -Filter "mysql.exe"

# ä½¿ç”¨æ‰¾åˆ°çš„è·¯å¾„æ‰§è¡Œï¼ˆæ›¿æ¢ä¸ºå®é™…è·¯å¾„ï¼‰
& "è·¯å¾„\mysql.exe" -u root -pHtht1234 evaluate_db < migrations\002_create_model_management.sql
& "è·¯å¾„\mysql.exe" -u root -pHtht1234 evaluate_db < migrations\003_init_model_formulas.sql
```

### æ­¥éª¤2: é‡å¯åç«¯æœåŠ¡ (30ç§’)

```powershell
# åœæ­¢å½“å‰æœåŠ¡
Stop-Job -Name "SpringBootApp"

# é‡æ–°å¯åŠ¨
Start-Job -ScriptBlock { 
    Set-Location 'C:\Users\Administrator\Development\evaluation'
    mvn spring-boot:run 
} -Name "SpringBootApp"

# ç­‰å¾…10ç§’åæ£€æŸ¥æ—¥å¿—
Start-Sleep 10
Receive-Job -Name "SpringBootApp" -Keep | Select-String "Started EvaluateApplication"
```

### æ­¥éª¤3: æµ‹è¯•API (10ç§’)

```powershell
# æµ‹è¯•è·å–æ¨¡å‹åˆ—è¡¨
$response = Invoke-WebRequest -Uri "http://localhost:8081/api/model-management/models" -Method GET
$response.Content | ConvertFrom-Json | ConvertTo-Json -Depth 10

# åº”è¯¥è¿”å›é»˜è®¤æ¨¡å‹ "æ ‡å‡†å‡ç¾èƒ½åŠ›è¯„ä¼°æ¨¡å‹"
```

## ğŸ¯ å¿«é€ŸéªŒè¯

### éªŒè¯1: æŸ¥çœ‹é»˜è®¤æ¨¡å‹
```powershell
Invoke-RestMethod -Uri "http://localhost:8081/api/model-management/models" -Method GET
```

æœŸæœ›è¾“å‡ºï¼š
```json
{
  "success": true,
  "data": [
    {
      "id": 1,
      "modelName": "æ ‡å‡†å‡ç¾èƒ½åŠ›è¯„ä¼°æ¨¡å‹",
      "modelCode": "STANDARD_MODEL",
      "description": "åŸºäºTOPSISç®—æ³•çš„æ ‡å‡†å‡ç¾èƒ½åŠ›è¯„ä¼°æ¨¡å‹...",
      "status": 1,
      "isDefault": true
    }
  ]
}
```

### éªŒè¯2: æŸ¥çœ‹æ¨¡å‹è¯¦æƒ…
```powershell
Invoke-RestMethod -Uri "http://localhost:8081/api/model-management/models/1/detail" -Method GET
```

åº”è¯¥è¿”å›æ¨¡å‹çš„7ä¸ªæ­¥éª¤å’Œå¯¹åº”ç®—æ³•ã€‚

### éªŒè¯3: éªŒè¯QLExpressè¡¨è¾¾å¼
```powershell
$body = @{
    expression = "(management_staff / population) * 10000"
    context = @{
        management_staff = 10
        population = 1000
    }
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8081/api/model-management/validate-expression" `
    -Method POST `
    -Body $body `
    -ContentType "application/json"
```

æœŸæœ›è¾“å‡ºï¼š
```json
{
  "success": true,
  "valid": true,
  "errorMessage": null
}
```

## ğŸ“ ä¸‹ä¸€æ­¥ï¼šåˆ›å»ºå‰ç«¯é¡µé¢

### å¯é€‰ï¼šåˆ›å»ºæ¨¡å‹ç®¡ç†é¡µé¢

å‚è€ƒ `QLExpresså®æ–½æŒ‡å—.md` åˆ›å»ºï¼š

1. `frontend/src/views/ModelManagement.vue`
2. æ›´æ–°è·¯ç”±å’Œèœå•
3. æ·»åŠ APIæ¥å£å®šä¹‰

æˆ–è€…ç›´æ¥ä½¿ç”¨APIè¿›è¡Œæµ‹è¯•ï¼

## ğŸ”§ å¸¸ç”¨APIå‘½ä»¤

### åˆ›å»ºæ–°æ¨¡å‹
```powershell
$newModel = @{
    modelName = "æµ‹è¯•è¯„ä¼°æ¨¡å‹"
    modelCode = "TEST_MODEL"
    description = "ç”¨äºæµ‹è¯•çš„è¯„ä¼°æ¨¡å‹"
    version = "1.0"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8081/api/model-management/models" `
    -Method POST `
    -Body $newModel `
    -ContentType "application/json"
```

### ä¸ºæ¨¡å‹æ·»åŠ æ­¥éª¤
```powershell
$newStep = @{
    stepName = "æ•°æ®é¢„å¤„ç†"
    stepCode = "DATA_PREPROCESSING"
    stepOrder = 1
    stepType = "CALCULATION"
    description = "å¯¹åŸå§‹æ•°æ®è¿›è¡Œé¢„å¤„ç†"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8081/api/model-management/models/2/steps" `
    -Method POST `
    -Body $newStep `
    -ContentType "application/json"
```

### æ·»åŠ ç®—æ³•
```powershell
$newAlgorithm = @{
    algorithmName = "äººå£å¯†åº¦è®¡ç®—"
    algorithmCode = "POPULATION_DENSITY"
    algorithmOrder = 1
    qlExpression = "(population / area) * 1000"
    outputParam = "population_density"
    description = "è®¡ç®—äººå£å¯†åº¦"
} | ConvertTo-Json

Invoke-RestMethod -Uri "http://localhost:8081/api/model-management/steps/1/algorithms" `
    -Method POST `
    -Body $newAlgorithm `
    -ContentType "application/json"
```

## ğŸ“Š ç³»ç»Ÿæ¶æ„å›¾

```
ç”¨æˆ·ç•Œé¢ (Vue 3)
    â†“
æ¨¡å‹ç®¡ç†API (/api/model-management)
    â†“
QLExpresså¼•æ“æœåŠ¡ (QLExpressService)
    â†“
æ•°æ®åº“ (evaluation_model, model_step, step_algorithm)
    â†“
è¯„ä¼°æ‰§è¡Œå¼•æ“
    â†“
ç»“æœå±•ç¤º
```

## ğŸ“ QLExpressè¡¨è¾¾å¼é€ŸæŸ¥

| ç±»å‹ | å‡½æ•° | ç¤ºä¾‹ |
|------|------|------|
| ç®—æœ¯ | +, -, *, / | `(a + b) / 2` |
| æ¯”è¾ƒ | ==, !=, <, >, <=, >= | `value >= 100` |
| é€»è¾‘ | &&, \|\|, ! | `a > 0 && b < 10` |
| æ¡ä»¶ | ? : | `score >= 60 ? "é€šè¿‡" : "ä¸é€šè¿‡"` |
| æ•°å­¦ | SQRT, POW | `SQRT(value)`, `POW(x, 2)` |
| ç»Ÿè®¡ | AVERAGE, STDEV, SUMSQ | `AVERAGE(values)` |

## âš¡ æ•…éšœæ’æŸ¥

### é—®é¢˜1: åç«¯å¯åŠ¨å¤±è´¥
```powershell
# æŸ¥çœ‹è¯¦ç»†æ—¥å¿—
Receive-Job -Name "SpringBootApp" -Keep
```

### é—®é¢˜2: æ•°æ®åº“è¿æ¥å¤±è´¥
æ£€æŸ¥MySQLæœåŠ¡æ˜¯å¦è¿è¡Œï¼š
```powershell
netstat -an | findstr :3306
```

### é—®é¢˜3: APIè¿”å›404
ç¡®è®¤åç«¯å·²å¯åŠ¨å¹¶ç›‘å¬8081ç«¯å£ï¼š
```powershell
netstat -an | findstr :8081
```

## ğŸ“š å®Œæ•´æ–‡æ¡£

- **WARP.md** - é¡¹ç›®æ•´ä½“æ¶æ„
- **QLExpresså®æ–½æŒ‡å—.md** - è¯¦ç»†å®æ–½æ­¥éª¤
- **å®Œæˆæ€»ç»“.md** - å·²å®Œæˆå·¥ä½œå’Œä¸‹ä¸€æ­¥è®¡åˆ’

## ğŸ‰ æ­å–œï¼

ç³»ç»Ÿå·²æˆåŠŸå¼•å…¥QLExpressåŠ¨æ€è§„åˆ™å¼•æ“ï¼ç°åœ¨å¯ä»¥ï¼š

âœ… é€šè¿‡APIåŠ¨æ€åˆ›å»ºå’Œç®¡ç†è¯„ä¼°æ¨¡å‹  
âœ… é…ç½®QLExpressè¡¨è¾¾å¼è€Œæ— éœ€ä¿®æ”¹ä»£ç   
âœ… å®æ—¶éªŒè¯è¡¨è¾¾å¼è¯­æ³•  
âœ… è·Ÿè¸ªæ¨¡å‹æ‰§è¡Œå†å²  

å¼€å§‹æ¢ç´¢æ–°åŠŸèƒ½å§ï¼ ğŸš€