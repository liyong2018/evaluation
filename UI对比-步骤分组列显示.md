# UI对比 - 步骤分组列显示功能

## 更新前后对比

### 更新前 - 简单的复选框列表

在多步骤结果页面中，列显示控制使用的是简单的复选框列表，没有分组：

```
┌─────────────────────────────────┐
│ 列显示控制                       │
├─────────────────────────────────┤
│ ☑ 地区代码                       │
│ ☑ 地区名称                       │
│ ☑ 防洪治洪能力权重               │
│ ☑ 公众应急能力权重               │
│ ☑ 财政负荷入能力权重             │
│ ☑ 财政保入能力权重               │
│ ☑ 医疗保健能力权重               │
│ ☑ 物资保障能力权重               │
│ ☑ 科技赋能能力权重               │
│ ☑ 应灾响应能力权重               │
│ ... (更多列)                     │
├─────────────────────────────────┤
│ [全选] [取消全选] [重置]         │
└─────────────────────────────────┘
```

**问题**：
- 列太多时不易管理
- 没有逻辑分组，查找困难
- 不知道哪些列属于哪个计算步骤

### 更新后 - 按步骤分组的折叠面板

在多步骤结果页面中，列显示控制改为按步骤分组的折叠面板：

```
┌─────────────────────────────────────────────┐
│ 列显示控制                                   │
├─────────────────────────────────────────────┤
│ ▼ 基础信息（2列）                            │
│   [选择该组] [取消该组]                      │
│   ☑ 地区代码                                 │
│   ☑ 地区名称                                 │
├─────────────────────────────────────────────┤
│ ▶ 步骤1 多准则决策减灾能力评估模型-定权（8列） │
├─────────────────────────────────────────────┤
│ ▼ 步骤2 多准则决策减灾能力评估模型-优劣解算（10列）│
│   [选择该组] [取消该组]                      │
│   ☑ 防洪治洪能力正理想解                     │
│   ☑ 公众应急能力正理想解                     │
│   ☑ 财政负荷入能力正理想解                   │
│   ☑ 防洪治洪能力负理想解                     │
│   ☑ 公众应急能力负理想解                     │
│   ☑ 防洪治洪能力正距离                       │
│   ☑ 公众应急能力正距离                       │
│   ☑ 防洪治洪能力负距离                       │
│   ☑ 防洪治洪能力贴近度                       │
│   ☑ 公众应急能力贴近度                       │
├─────────────────────────────────────────────┤
│ ▶ 步骤3 多准则决策减灾能力评估模型-分级（2列）  │
├─────────────────────────────────────────────┤
│ ▶ 步骤4 多准则决策减灾能力评估模型-指标计算（3列）│
├─────────────────────────────────────────────┤
│ [全选] [取消全选] [重置]                     │
└─────────────────────────────────────────────┘
```

**优势**：
- ✅ 按步骤逻辑分组，结构清晰
- ✅ 可以展开/收起分组，节省空间
- ✅ 每个分组显示列数统计
- ✅ 可以快速选择/取消整个分组
- ✅ 与单表格结果页面的UI保持一致

## 功能对比表

| 功能特性 | 更新前 | 更新后 |
|---------|-------|-------|
| 列显示/隐藏 | ✅ | ✅ |
| 全选/取消全选 | ✅ | ✅ |
| 重置功能 | ✅ | ✅ |
| 按步骤分组 | ❌ | ✅ |
| 折叠/展开分组 | ❌ | ✅ |
| 快速选择整组 | ❌ | ✅ |
| 显示列数统计 | ❌ | ✅ |
| 步骤名称显示 | ❌ | ✅ |
| 智能关键字分组（兜底） | ❌ | ✅ |

## 交互流程对比

### 更新前的操作流程
1. 在评估页面点击"查看所有步骤结果"
2. 弹出结果对话框
3. 从下拉列表选择步骤
4. 从长列表中逐个勾选/取消勾选列
5. 查看筛选后的结果

**痛点**：当有几十列时，需要不断滚动查找目标列

### 更新后的操作流程
1. 在评估页面点击"查看所有步骤结果"
2. 弹出结果对话框
3. 从下拉列表选择步骤
4. **展开感兴趣的步骤分组**
5. **点击"选择该组"或逐个勾选列**
6. 查看筛选后的结果

**改进**：
- 可以按分组快速操作，无需逐列查找
- 分组折叠让界面更整洁
- 步骤名称帮助理解列的含义

## 技术架构对比

### 更新前
```
ResultDialog.vue
├── 多步骤模式
│   ├── 简单复选框列表
│   ├── allColumns 数组
│   └── visibleColumns 数组
└── 单表格模式
    ├── 分组折叠面板
    ├── columnGroups 计算属性
    ├── allColumns 数组
    └── visibleColumns 数组
```

**问题**：两种模式的UI不一致

### 更新后
```
ResultDialog.vue
├── 多步骤模式
│   ├── 分组折叠面板 ✨
│   ├── columnGroups 计算属性 ✨
│   ├── allColumns 数组
│   └── visibleColumns 数组
└── 单表格模式
    ├── 分组折叠面板
    ├── columnGroups 计算属性
    ├── allColumns 数组
    └── visibleColumns 数组
```

**改进**：
- ✅ 两种模式UI一致
- ✅ 共享核心逻辑（columnGroups）
- ✅ 都支持后端步骤映射
- ✅ 都有关键字兜底分组

## 截图参考位置

根据您提供的截图：

### 第一张截图（算法步骤和公式展示）
- 显示了"查看所有步骤结果"按钮的位置
- 在评估配置页面的算法步骤区域

### 第二张截图（评估计算配置）
- 展示了整体的评估计算页面布局
- 包含评估名称、权重配置、评估模型、评估算法等配置项

### 第三张截图（评估计算配置表单）
- 展示了完整的评估配置表单
- 底部有"开始评估"按钮

**更新的功能**主要体现在点击"查看所有步骤结果"按钮后弹出的对话框中，该对话框会显示：
1. 步骤选择器（下拉选择）
2. **列显示控制面板**（本次更新的重点）
3. 数据表格
4. 底部的导出和生成专题图按钮

## 用户收益

### 对于初级用户
- **更容易理解**：通过步骤分组，清楚知道每列数据来自哪个计算步骤
- **操作更简单**：不需要了解具体的列名，可以按步骤整组操作

### 对于高级用户
- **效率更高**：可以快速选择/取消整个步骤的输出
- **更灵活**：既可以按分组操作，也可以精确到单列
- **便于调试**：通过分组可以快速验证某个步骤的输出是否正确

### 对于开发和维护人员
- **代码复用**：多步骤和单表格模式共享核心逻辑
- **易于扩展**：新增步骤自动支持分组
- **调试友好**：详细的控制台日志便于排查问题
